{% block extra_css %}
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
{% endblock %}

<div class="card-panel">
    <form id="{{ id }}">
        <div id="editor"></div>
    </form>
</div>

{% block extra_scripts %}
    <!-- Quill -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- Initialize Quill editor -->
    <script>
        var editor = new Quill('#editor', {
            modules: {
                // syntax: true,
                toolbar: [
                    [{ 'header': 1 }, { 'header': 2 }, { 'header': 3 }],
                    ['bold', 'italic'],
                    ['link'],
                    [{ list: 'ordered' }, { list: 'bullet' }],
                    ['clean'],
                ],
                history: {
                    delay: 2000,
                    maxStack: 500,
                    userOnly: true
                },
            },
            placeholder: 'Ã‰crivez le corps de votre annonce ici...',
            theme: 'snow'
        });

        // This section allows Quill to be initialized with Deltas
        editor.setContents("{% if offre.description_longue %}{{ offre.description_longue|safe }}{% endif %}");

        // This section syncs Quill with a textarea in a form
        var form = document.querySelector("form");
        form.onsubmit = function() {
            // Populate hidden fields on submit
            var field = document.querySelector('input[name=description_longue]');
            var html_field = document.querySelector('input[name=description_longue_html]');
            var editor_content = editor.root.innerHTML;

            field.value = JSON.stringify(editor.getContents());
            html_field.value = editor_content;

            return;
        };
    </script>
{% endblock %}